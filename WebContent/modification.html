<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>User Profile Page - Ace Admin</title>

		<meta name="description" content="3 styles with inline editable feature" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<!-- basic styles -->

		<link href="assets2/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="assets2/css/font-awesome.min.css" />

		<!--[if IE 7]>
		  <link rel="stylesheet" href="assets2/css/font-awesome-ie7.min.css" />
		<![endif]-->

		<!-- page specific plugin styles -->

		<link rel="stylesheet" href="assets2/css/jquery-ui-1.10.3.custom.min.css" />
		<link rel="stylesheet" href="assets2/css/jquery.gritter.css" />
		<link rel="stylesheet" href="assets2/css/select2.css" />
		<link rel="stylesheet" href="assets2/css/bootstrap-editable.css" />
		
		<script src="js/jquery-3.2.1.min.js"></script>
    	<link href="css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all" /> 
  		<link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  		<link rel="stylesheet" href="css/bootstrap-table.css" />
  		<link href="js/advanced-datatable/css/demo_page.css" rel="stylesheet" />
  		<link href="js/advanced-datatable/css/demo_table.css" rel="stylesheet" />
 		<link rel="stylesheet" href="js/data-tables/DT_bootstrap.css" /> 

		<!-- fonts -->

		

		<!-- ace styles -->

		<link rel="stylesheet" href="assets2/css/ace.min.css" />
		<link rel="stylesheet" href="assets2/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="assets2/css/ace-skins.min.css" />
		<link rel="stylesheet" href="css/button.css">

		<!--[if lte IE 8]>
		  <link rel="stylesheet" href="assets2/css/ace-ie.min.css" />
		<![endif]-->

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->

		<script src="assets2/js/ace-extra.min.js"></script>

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

		<!--[if lt IE 9]>
		<script src="assets2/js/html5shiv.js"></script>
		<script src="assets2/js/respond.min.js"></script>
		<![endif]-->
	</head>

	<body>
	<button id = "goBack"  class="button button-large button-plain button-border button-circle" style= "background: #229ffd; position: relative; left: 10px" ><i class="fa fa-reply"></i></button>
	

					<div class="page-content">
						

						

								<div class="hr dotted"></div>
								<div >
									<div id="user-profile-3" class="user-profile row">
										<div class="col-sm-offset-1 col-sm-10">
											

											<div class="space"></div>

											<form class="form-horizontal" >
												<div class="tabbable"  >
													<ul class="nav nav-tabs padding-16">
														<li class="active">
															<a data-toggle="tab" href="#edit-basic">
																<i class="green icon-edit bigger-125"></i>
																基本信息
															</a>
														</li>

														

														<li>
															<a data-toggle="tab" href="#edit-password">
																<i class="blue icon-key bigger-125"></i>
																修改密码
															</a>
														</li>
													</ul>

													<div class="tab-content profile-edit-tab-content">
														<div id="edit-basic" class="tab-pane in active">
															<h4 class="header blue bolder smaller">General</h4>

															<div class="row">
																

																<div class="vspace-xs"></div>

																<div class="col-xs-12 col-sm-8">
																	<div class="form-group">
																		<label class="col-sm-4 control-label no-padding-right" for="form-field-username" style = "position:relative; left:34px">昵称</label>

																		<div class="col-sm-8">
																			<input class="col-xs-12 col-sm-10" type="text" id="userName" style = "width:192px; position:relative; left:34px"   />
																		</div>
																		
																		
																	</div>

																</div>
																
															</div>

															
															<div class="form-group">
																<label class="col-sm-3 control-label no-padding-right" for="form-field-date" style = "position:relative; ">出生日期</label>

																<div class="col-sm-9">
																	<div class="input-medium">
																		<div class="input-group">
																			<input class="input-medium date-picker" id="birthday" type="text" data-date-format="yyyy-mm-dd" placeholder="yyyy-mm-dd"  />
																			<span class="input-group-addon" >
																				<i class="icon-calendar" ></i>
																			</span>
																		</div>
																	</div>
																</div>
															</div>
															
															<div class="row">
																

																<div class="vspace-xs"></div>

																<div class="col-xs-12 col-sm-8">
																	<div class="form-group">
																		<label class="col-sm-4 control-label no-padding-right" for="form-field-username" style = "position:relative; left:34px">位置</label>

																		<div class="col-sm-8">
																			<input class="col-xs-12 col-sm-10" type="text" id="location" style = "width:192px; position:relative; left:34px"   />
																		</div>
																		
																		
																	</div>

																</div>
																
															</div>

															<div class="space-4"></div>

															<div class="form-group">
																<label class="col-sm-3 control-label no-padding-right" >性别</label>

																<div class="col-sm-9" >
																	<label class="inline">
																		<input name="form-field-radio" type="radio" class="ace" id = "male" />
																		<span class="lbl"> 男</span>
																	</label>

																	&nbsp; &nbsp; &nbsp;
																	<label class="inline">
																		<input name="form-field-radio" type="radio" class="ace" id = "female" />
																		<span class="lbl"> 女</span>
																	</label>
																</div>
															</div>

															<h4 class="header blue bolder smaller">联系方式</h4>

															<div class="form-group">
																<label class="col-sm-3 control-label no-padding-right" for="form-field-email" style = "position:relative;  top:30px">邮件</label>

																<div class="col-sm-9" style = "position:relative;  top:30px">
																	<span class="input-icon input-icon-right">
																		<input type="email" id="email" value="alexdoe@gmail.com" />
																		<i class="icon-envelope"></i>
																	</span>
																</div>
															</div>

															
															

															<div class="space"></div>
															<h4 class="header blue bolder smaller">社交</h4>

															<div class="form-group">
																<label class="col-sm-3 control-label no-padding-right" for="form-field-facebook" style = "position:relative;  top:10px">微信</label>

																<div class="col-sm-9" style = "position:relative;  top:10px">
																	<span class="input-icon">
																		<input type="text" value="" id="wechat" />
																		
																	</span>
																</div>
															</div>

															<div class="space-4"></div>

															<div class="form-group">
																<label class="col-sm-3 control-label no-padding-right" for="form-field-twitter" style = "position:relative;  top:10px">QQ</label>

																<div class="col-sm-9" style = "position:relative;  top:10px">
																	<span class="input-icon">
																		<input type="text" value="" id="qq" />
																		
																	</span>
																</div>
															</div>

															<div class="space-4"></div>

															
														</div>

														<div id="edit-settings" class="tab-pane">
															<div class="space-10"></div>

															<div>
																<label class="inline">
																	<input type="checkbox" name="form-field-checkbox" class="ace" />
																	<span class="lbl"> Make my profile public</span>
																</label>
															</div>

															<div class="space-8"></div>

															<div>
																<label class="inline">
																	<input type="checkbox" name="form-field-checkbox" class="ace" />
																	<span class="lbl"> Email me new updates</span>
																</label>
															</div>

															<div class="space-8"></div>

															<div>
																<label class="inline">
																	<input type="checkbox" name="form-field-checkbox" class="ace" />
																	<span class="lbl"> Keep a history of my conversations</span>
																</label>

																<label class="inline">
																	<span class="space-2 block"></span>

																	for
																	<input type="text" class="input-mini" maxlength="3" />
																	days
																</label>
															</div>
														</div>

														<div id="edit-password" class="tab-pane">
															<div class="space-10"></div>

															<div class="form-group">
																<label class="col-sm-3 control-label no-padding-right" for="form-field-pass1">New Password</label>

																<div class="col-sm-9">
																	<input type="password" id="form-field-pass1" />
																</div>
															</div>

															<div class="space-4"></div>

															<div class="form-group">
																<label class="col-sm-3 control-label no-padding-right" for="form-field-pass2">Confirm Password</label>

																<div class="col-sm-9">
																	<input type="password" id="form-field-pass2" />
																</div>
															</div>
														</div>
													</div>
												</div>

												<div class="clearfix form-actions">
													<div class="col-md-offset-3 col-md-9">
														<button class="btn btn-info" type="button" id = "change">
															<i class="icon-ok bigger-110"></i>
															Save
														</button>

														&nbsp; &nbsp;
														
													</div>
													
												</div>
											</form>
										</div><!-- /span -->
									</div><!-- /user-profile -->
								</div>

								<!-- PAGE CONTENT ENDS -->
							</div><!-- /.col -->
						</div><!-- /.row -->
					</div><!-- /.page-content -->
				</div><!-- /.main-content -->

				

					
				</div><!-- /#ace-settings-container -->
			</div><!-- /.main-container-inner -->

			<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
				<i class="icon-double-angle-up icon-only bigger-110"></i>
			</a>
		</div><!-- /.main-container -->
      




        
         <ul class="breadcrumb" style = "position:absolute; left:80px; top:15px;background-color:rgba(0,0,0,0)">
							<li>
								<a href="http://localhost:8088/ssf/index.html" style = "font-size:20px">首页</a>
							</li>
							<li>
								<a href="http://localhost:8088/ssf/profile.html" style = "font-size:20px">个人中心</a>
							</li>
							<li class="active" style = "font-size:20px">信息修改</li>
						</ul>
		<!-- basic scripts -->

		<!--[if !IE]> -->

		

		<!-- <![endif]-->

		<!--[if IE]>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<![endif]-->

		<!--[if !IE]> -->

		<script type="text/javascript">
			window.jQuery || document.write("<script src='assets2/js/jquery-2.0.3.min.js'>"+"<"+"/script>");
		</script>

		<!-- <![endif]-->

		<!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='assets2/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
</script>
<![endif]-->

		<script type="text/javascript">
			if("ontouchend" in document) document.write("<script src='assets2/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
		</script>
		<script src="assets2/js/bootstrap.min.js"></script>
		<script src="assets2/js/typeahead-bs2.min.js"></script>

		<!-- page specific plugin scripts -->

		<!--[if lte IE 8]>
		  <script src="assets2/js/excanvas.min.js"></script>
		<![endif]-->

		<script src="assets2/js/jquery-ui-1.10.3.custom.min.js"></script>
		<script src="assets2/js/jquery.ui.touch-punch.min.js"></script>
		<script src="assets2/js/jquery.gritter.min.js"></script>
		<script src="assets2/js/bootbox.min.js"></script>
		<script src="assets2/js/jquery.slimscroll.min.js"></script>
		<script src="assets2/js/jquery.easy-pie-chart.min.js"></script>
		<script src="assets2/js/jquery.hotkeys.min.js"></script>
		<script src="assets2/js/bootstrap-wysiwyg.min.js"></script>
		<script src="assets2/js/select2.min.js"></script>
		<script src="assets2/js/date-time/bootstrap-datepicker.min.js"></script>
		<script src="assets2/js/fuelux/fuelux.spinner.min.js"></script>
		<script src="assets2/js/x-editable/bootstrap-editable.min.js"></script>
		<script src="assets2/js/x-editable/ace-editable.min.js"></script>
		<script src="assets2/js/jquery.maskedinput.min.js"></script>

		<!-- ace scripts -->

		<script src="assets2/js/ace-elements.min.js"></script>
		<script src="assets2/js/ace.min.js"></script>

		<!-- inline scripts related to this page -->

		<script type="text/javascript">
		
		function reWriteSession(name){
			$.ajax({
				url:"usert/rewriteSession.action",
				method:"POST",
				data:{
					"uname":name,
				},
				success:function(data){
					//alert("success!");
					location.href = "http://localhost:8088/ssf/profile.html";
				},
				error:function(){
					alert("error!");
				}
			})
			
		};
		
		
		function dynamicProfile2(){
			
			 $.ajax({
			    	url:"usert/dynamicProfile.action",
				    method: "GET",
				    data:{
				    	"uid": uidGlobal,
				    },
				    success:function(data){
				    	$("#userName").val(data.uname);
				    	$("#birthday").val(data.ubirthdate);
				    	if(data.location != null)
				    		{
				    		$("#location").val(data.location);
				    		}
				    	if(data.ue_mail != null)
				    		{
				    		$("#email").val(data.ue_mail);
				    		}
				    	else
				    		{
				    		$("#email").val("暂未填写");
				    		}
				    	
				    	if(data.uwechat != null)
			    		{
				    		$("#wechat").val(data.uwechat);
			    		}
			    		else
			    		{
			    			$("#wechat").val("暂未填写");
			    		}
				    	
				    	if(data.uqq != null)
			    		{
				    		$("#qq").val(data.uqq);
			    		}
			    		else
			    		{
			    			$("#qq").val("暂未填写");
			    		}
				    	
				    	if(data.usex == "male")
				    		{
				    		$("#male").attr("checked", "checked"); 
				    		}
				    	else if (data.usex == "female")
				    		{
				    		$("#female").attr("checked", "checked");
				    		}
				    	console.log($("#birthday").val());
				    	
				    	
				    },
				    error:function(){
				    	
					     alert("error!");
					
				    }
				    
				    
			    });
		}
		var uidGlobal;
		   $(document).ready(function(){
			   $.ajax({
			    	url:"usert/getSession.action",
				    method: "GET",
				    
				    success:function(data){
					     if(data.uid!= null) {
					    	 uidGlobal = data.uid;	
					    	 dynamicProfile2();
					    	 }
					     else{
					    	 alert("请登录");
					    	 location.href = "http://localhost:8088/ssf/index.html";
					     }
					     
						  
				    },
				    error:function(){
				    	
					     alert("error!获取session");
					
				    }
				    
				    
			    });
			 
			   
		   })		   
		   $("#goBack").click(function(){
			   
			location.href = "http://localhost:8088/ssf/profile.html";
		
		   });
		   
		   $("#change").click(function(){
			   var pwd = $("#form-field-pass1").val();
			   var pwd2 = $("#form-field-pass2").val();
			   if(pwd != "" && pwd == pwd2)
				   {
				   $.ajax({
						url : "usert/updatePassword.action",
								method : "GET",
								data : {
									"uid" : uidGlobal,
									"pwd" : pwd,
								},
								success : function(data) {
									if (data == 1) {
										alert("更改密码成功");
										$("#form-field-pass1").val("");
										$("#form-field-pass2").val("");
										
									}
									window.location.href = "http://localhost:8088/ssf/profile.html";
								},
								error : function() {

									alert("更改密码error!");

								}

							});
				   }
			   else if (pwd != "" && pwd != pwd2)
				   {
				   alert("两次密码不一致");
				   }
			   else
				   {
				   var uname = $("#userName").val();
				   var location =$("#location").val();
				   var birthday = $("#birthday").val();
				   var email = $("#email").val();
				   var wechat = $("#wechat").val();
				   var qq = $("#qq").val();
				   var sex;
				   var sex1 = $("#male").attr("checked");
				   var sex2 = $("#female").attr("checked");
				   console.log(birthday);
				   if(sex1 == "checked")
					   {
					   sex = "male";
					   }
				   
				   else if(sex2 == "checked")
				   {
				   sex = "female";
				   }
				   else
				   {
					   sex = null;
				   }
				   
				   //alert(location);
				   $.ajax({
					   url:"usert/updateUser.action",
					    method: "POST",
					    data:{
					    	"uid": uidGlobal,
					    	"uname": uname,
					    	"ue_mail":email,
					    	"uwechat":wechat,
					    	"uqq":qq,
					    	"usex":sex,
					    	"location":location,
					    	"birthday":birthday
					    },
					    success:function(data){
					    	alert("成功修改"+uname);
					    	reWriteSession(uname);
					    	
						    // location.href = "http://localhost:8088/ssf/profile.html";

						},
						error : function() {

							alert("修改信息错误");

						}

					});
				   }
			   
			  
			});

			/*$("#changePassword").click(
							function() {
								var pwd = $("#form-field-pass1").val();
								var pwd2 = $("#form-field-pass2").val();
								alert("111");
								if (pwd == pwd2) {
									$.ajax({
										url : "usert/updatePassword.action",
												method : "GET",
												data : {
													"uid" : uidGlobal,
													"pwd" : pwd,
												},
												success : function(data) {
													if (data == 1) {
														alert("更改密码成功");
														location.href = "http://localhost:8088/ssf/profile.html";
													}
												},
												error : function() {

													alert("更改密码error!");

												}

											});
								} else {
									alert("两次密码输入不一致");
								}

							});*/

			jQuery(function($) {

				//editables on first profile page
				$.fn.editable.defaults.mode = 'inline';
				$.fn.editableform.loading = "<div class='editableform-loading'><i class='light-blue icon-2x icon-spinner icon-spin'></i></div>";
				$.fn.editableform.buttons = '<button type="submit" class="btn btn-info editable-submit"><i class="icon-ok icon-white"></i></button>'
						+ '<button type="button" class="btn editable-cancel"><i class="icon-remove"></i></button>';

				//editables 
				$('#username').editable({
					type : 'text',
					name : 'username'
				});

				var countries = [];
				$.each({
					"CA" : "Canada",
					"IN" : "India",
					"NL" : "Netherlands",
					"TR" : "Turkey",
					"US" : "United States"
				}, function(k, v) {
					countries.push({
						id : k,
						text : v
					});
				});

				var cities = [];
				cities["CA"] = [];
				$.each([ "Toronto", "Ottawa", "Calgary", "Vancouver" ],
						function(k, v) {
							cities["CA"].push({
								id : v,
								text : v
							});
						});
				cities["IN"] = [];
				$.each([ "Delhi", "Mumbai", "Bangalore" ], function(k, v) {
					cities["IN"].push({
						id : v,
						text : v
					});
				});
				cities["NL"] = [];
				$.each([ "Amsterdam", "Rotterdam", "The Hague" ],
						function(k, v) {
							cities["NL"].push({
								id : v,
								text : v
							});
						});
				cities["TR"] = [];
				$.each([ "Ankara", "Istanbul", "Izmir" ], function(k, v) {
					cities["TR"].push({
						id : v,
						text : v
					});
				});
				cities["US"] = [];
				$.each([ "New York", "Miami", "Los Angeles", "Chicago",
						"Wysconsin" ], function(k, v) {
					cities["US"].push({
						id : v,
						text : v
					});
				});

				var currentValue = "NL";
				$('#country')
						.editable(
								{
									type : 'select2',
									value : 'NL',
									source : countries,
									success : function(response, newValue) {
										if (currentValue == newValue)
											return;
										currentValue = newValue;

										var new_source = (!newValue || newValue == "") ? []
												: cities[newValue];

										//the destroy method is causing errors in x-editable v1.4.6
										//it worked fine in v1.4.5
										/**			
										$('#city').editable('destroy').editable({
											type: 'select2',
											source: new_source
										}).editable('setValue', null);
										 */

										//so we remove it altogether and create a new element
										var city = $('#city').removeAttr('id')
												.get(0);
										$(city).clone().attr('id', 'city')
												.text('Select City').editable({
													type : 'select2',
													value : null,
													source : new_source
												}).insertAfter(city);//insert it after previous instance
										$(city).remove();//remove previous instance

									}
								});

				$('#city').editable({
					type : 'select2',
					value : 'Amsterdam',
					source : cities[currentValue]
				});

				$('#signup').editable({
					type : 'date',
					format : 'yyyy-mm-dd',
					viewformat : 'dd/mm/yyyy',
					datepicker : {
						weekStart : 1
					}
				});

				$('#age').editable({
					type : 'spinner',
					name : 'age',
					spinner : {
						min : 16,
						max : 99,
						step : 1
					}
				});

				//var $range = document.createElement("INPUT");
				//$range.type = 'range';
				$('#login').editable({
					type : 'slider',//$range.type == 'range' ? 'range' : 'slider',
					name : 'login',
					slider : {
						min : 1,
						max : 50,
						width : 100
					},
					success : function(response, newValue) {
						if (parseInt(newValue) == 1)
							$(this).html(newValue + " hour ago");
						else
							$(this).html(newValue + " hours ago");
					}
				});

				$('#about').editable({
					mode : 'inline',
					type : 'wysiwyg',
					name : 'about',
					wysiwyg : {
					//css : {'max-width':'300px'}
					},
					success : function(response, newValue) {
					}
				});

				// *** editable avatar *** //
				try {//ie8 throws some harmless exception, so let's catch it

					//it seems that editable plugin calls appendChild, and as Image doesn't have it, it causes errors on IE at unpredicted points
					//so let's have a fake appendChild for it!
					if (/msie\s*(8|7|6)/
							.test(navigator.userAgent.toLowerCase()))
						Image.prototype.appendChild = function(el) {
						}

					var last_gritter
					$('#avatar')
							.editable(
									{
										type : 'image',
										name : 'avatar',
										value : null,
										image : {
											//specify ace file input plugin's options here
											btn_choose : 'Change Avatar',
											droppable : true,
											/**
											//this will override the default before_change that only accepts image files
											before_change: function(files, dropped) {
												return true;
											},
											 */

											//and a few extra ones here
											name : 'avatar',//put the field name here as well, will be used inside the custom plugin
											max_size : 110000,//~100Kb
											on_error : function(code) {//on_error function will be called when the selected file has a problem
												if (last_gritter)
													$.gritter
															.remove(last_gritter);
												if (code == 1) {//file format error
													last_gritter = $.gritter
															.add({
																title : 'File is not an image!',
																text : 'Please choose a jpg|gif|png image!',
																class_name : 'gritter-error gritter-center'
															});
												} else if (code == 2) {//file size rror
													last_gritter = $.gritter
															.add({
																title : 'File too big!',
																text : 'Image size should not exceed 100Kb!',
																class_name : 'gritter-error gritter-center'
															});
												} else {//other error
												}
											},
											on_success : function() {
												$.gritter.removeAll();
											}
										},
										url : function(params) {
											// ***UPDATE AVATAR HERE*** //
											//You can replace the contents of this function with examples/profile-avatar-update.js for actual upload

											var deferred = new $.Deferred

											//if value is empty, means no valid files were selected
											//but it may still be submitted by the plugin, because "" (empty string) is different from previous non-empty value whatever it was
											//so we return just here to prevent problems
											var value = $('#avatar')
													.next()
													.find(
															'input[type=hidden]:eq(0)')
													.val();
											if (!value || value.length == 0) {
												deferred.resolve();
												return deferred.promise();
											}

											//dummy upload
											setTimeout(
													function() {
														if ("FileReader" in window) {
															//for browsers that have a thumbnail of selected image
															var thumb = $(
																	'#avatar')
																	.next()
																	.find('img')
																	.data(
																			'thumb');
															if (thumb)
																$('#avatar')
																		.get(0).src = thumb;
														}

														deferred.resolve({
															'status' : 'OK'
														});

														if (last_gritter)
															$.gritter
																	.remove(last_gritter);
														last_gritter = $.gritter
																.add({
																	title : 'Avatar Updated!',
																	text : 'Uploading to server can be easily implemented. A working example is included with the template.',
																	class_name : 'gritter-info gritter-center'
																});

													},
													parseInt(Math.random() * 800 + 800))

											return deferred.promise();
										},

										success : function(response, newValue) {
										}
									})
				} catch (e) {
				}

				//another option is using modals
				$('#avatar2')
						.on(
								'click',
								function() {
									var modal = '<div class="modal hide fade">\
						<div class="modal-header">\
							<button type="button" class="close" data-dismiss="modal">&times;</button>\
							<h4 class="blue">Change Avatar</h4>\
						</div>\
						\
						<form class="no-margin">\
						<div class="modal-body">\
							<div class="space-4"></div>\
							<div style="width:75%;margin-left:12%;"><input type="file" name="file-input" /></div>\
						</div>\
						\
						<div class="modal-footer center">\
							<button type="submit" class="btn btn-small btn-success"><i class="icon-ok"></i> Submit</button>\
							<button type="button" class="btn btn-small" data-dismiss="modal"><i class="icon-remove"></i> Cancel</button>\
						</div>\
						</form>\
					</div>';

									var modal = $(modal);

									var working = false;

									var form = modal.find('form:eq(0)');
									var file = form.find('input[type=file]')
											.eq(0);
									file
											.ace_file_input({
												style : 'well',
												btn_choose : 'Click to choose new avatar',
												btn_change : null,
												no_icon : 'icon-picture',
												thumbnail : 'small',
												before_remove : function() {
													//don't remove/reset files while being uploaded
													return !working;
												},
												before_change : function(files,
														dropped) {
													var file = files[0];
													if (typeof file === "string") {
														//file is just a file name here (in browsers that don't support FileReader API)
														if (!(/\.(jpe?g|png|gif)$/i)
																.test(file))
															return false;
													} else {//file is a File object
														var type = $
																.trim(file.type);
														if ((type.length > 0 && !(/^image\/(jpe?g|png|gif)$/i)
																.test(type))
																|| (type.length == 0 && !(/\.(jpe?g|png|gif)$/i)
																		.test(file.name))//for android default browser!
														)
															return false;

														if (file.size > 110000) {//~100Kb
															return false;
														}
													}

													return true;
												}
											});

									form
											.on(
													'submit',
													function() {
														if (!file
																.data('ace_input_files'))
															return false;

														file
																.ace_file_input('disable');
														form
																.find('button')
																.attr(
																		'disabled',
																		'disabled');
														form
																.find(
																		'.modal-body')
																.append(
																		"<div class='center'><i class='icon-spinner icon-spin bigger-150 orange'></i></div>");

														var deferred = new $.Deferred;
														working = true;
														deferred
																.done(function() {
																	form
																			.find(
																					'button')
																			.removeAttr(
																					'disabled');
																	form
																			.find(
																					'input[type=file]')
																			.ace_file_input(
																					'enable');
																	form
																			.find(
																					'.modal-body > :last-child')
																			.remove();

																	modal
																			.modal("hide");

																	var thumb = file
																			.next()
																			.find(
																					'img')
																			.data(
																					'thumb');
																	if (thumb)
																		$(
																				'#avatar2')
																				.get(
																						0).src = thumb;

																	working = false;
																});

														setTimeout(
																function() {
																	deferred
																			.resolve();
																},
																parseInt(Math
																		.random() * 800 + 800));

														return false;
													});

								});

				$(document).on('click','#add-without-image1',function() {
									//alert(345);
									//获取动态title属性的值
									var uid = $(this).attr("title");
									// alert("uid : "+uid);	 
									location.href = "http://localhost:8088/ssf/wines.html?uid="
											+ uid;
								});

				$(document).on('click', '#add-without-image2', function() {

					var uid = $(this).attr("title");
					var uidGlobal;
					$.ajax({
						url : "usert/getSession.action",
						method : "GET",
						success : function(data) {
							if (data.uid != null) {
								uidGlobal = data.uid;

								$.ajax({
									url : "usert/removeSubscribe.action",
									method : "POST",
									data : {
										uid : uidGlobal,
										sid : uid,
									},

									success : function() {
										alert("取消关注成功");
										window.location.reload();
										s

									},

									error : function() {
										console.log(uidGlobal + " " + uid);
										alert("取消关注error");

									}
								});

							}

						},
						error : function() {

							alert("error2!");

						}
					});
				});

				//////////////////////////////
				$('#profile-feed-1').slimScroll({
					height : '250px',
					alwaysVisible : true
				});

				$('.profile-social-links > a').tooltip();

				$('.easy-pie-chart.percentage').each(function() {
					var barColor = $(this).data('color') || '#555';
					var trackColor = '#E2E2E2';
					var size = parseInt($(this).data('size')) || 72;
					$(this).easyPieChart({
						barColor : barColor,
						trackColor : trackColor,
						scaleColor : false,
						lineCap : 'butt',
						lineWidth : parseInt(size / 10),
						animate : false,
						size : size
					}).css('color', barColor);
				});

				///////////////////////////////////////////

				//show the user info on right or left depending on its position
				$('#user-profile-2 .memberdiv').on(
						'mouseenter',
						function() {
							var $this = $(this);
							var $parent = $this.closest('.tab-pane');

							var off1 = $parent.offset();
							var w1 = $parent.width();

							var off2 = $this.offset();
							var w2 = $this.width();

							var place = 'left';
							if (parseInt(off2.left) < parseInt(off1.left)
									+ parseInt(w1 / 2))
								place = 'right';

							$this.find('.popover').removeClass('right left')
									.addClass(place);
						}).on('click', function() {
					return false;
				});

				///////////////////////////////////////////
				$('#user-profile-3')
						.find('input[type=file]')
						.ace_file_input(
								{
									style : 'well',
									btn_choose : 'Change avatar',
									btn_change : null,
									no_icon : 'icon-picture',
									thumbnail : 'large',
									droppable : true,
									before_change : function(files, dropped) {
										var file = files[0];
										if (typeof file === "string") {//files is just a file name here (in browsers that don't support FileReader API)
											if (!(/\.(jpe?g|png|gif)$/i)
													.test(file))
												return false;
										} else {//file is a File object
											var type = $.trim(file.type);
											if ((type.length > 0 && !(/^image\/(jpe?g|png|gif)$/i)
													.test(type))
													|| (type.length == 0 && !(/\.(jpe?g|png|gif)$/i)
															.test(file.name))//for android default browser!
											)
												return false;

											if (file.size > 110000) {//~100Kb
												return false;
											}
										}

										return true;
									}
								}).end().find('button[type=reset]').on(
								ace.click_event,
								function() {
									$('#user-profile-3 input[type=file]')
											.ace_file_input('reset_input');
								}).end().find('.date-picker').datepicker()
						.next().on(ace.click_event, function() {
							$(this).prev().focus();
						})
				$('.input-mask-phone').mask('(999) 999-9999');

				////////////////////
				//change profile
				$('[data-toggle="buttons"] .btn').on('click', function(e) {
					var target = $(this).find('input[type=radio]');
					var which = parseInt(target.val());
					$('.user-profile').parent().addClass('hide');
					$('#user-profile-' + which).parent().removeClass('hide');
				});
			});
		</script>
		
		<script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.scrollTo.min.js"></script>
    <script src="js/jquery.nicescroll.js" type="text/javascript"></script>

    <!--common script for all pages-->
    
    
	<script src="js/jquery-ui-1.9.2.custom.min.js"></script>
	<script src="js/jquery-migrate-1.2.1.min.js"></script>
	<script src="js/modernizr.min.js"></script>
	<script src="js/jquery.nicescroll.js"></script>
    <script src="js/bootstrap-table.js"></script>  
	<script src="js/bootstrap-table-export.js"></script>
	<script src="js/bootstrap-table-zh-CN.js"></script>
	<script src="js/tableExport.js"></script>

	<!--dynamic table-->
	<script type="text/javascript" src="js/advanced-datatable/js/jquery.dataTables.js"></script>
	<script type="text/javascript" src="js/data-tables/DT_bootstrap.js"></script>
	<!--dynamic table initialization -->
	<script src="js/dynamic_table_init.js"></script>
		
	</body>
</html>
